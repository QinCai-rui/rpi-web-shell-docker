services:
  fedora41:
    build:
      context: .
    container_name: web-shell-systemd
    stdin_open: true
    tty: true
    restart: unless-stopped
    network_mode: "none"
    volumes:
      - /sys/fs/cgroup:/sys/fs/cgroup:rw
      # Add host cgroup mount
      - /run/systemd/system:/run/systemd/system:ro
    tmpfs:
      - /tmp
      - /run
      - /run/lock
    environment:
      - "container=docker"
      - "SHELL_API_KEY=random-api-key"
#    privileged: true
    cap_drop:
      - ALL
#    cap_add:
#      - SYS_ADMIN
#      - NET_ADMIN
#      - SYS_NICE
#      - SYS_RESOURCE
    ports:
      - 5002:5001
    deploy:
      resources:
        limits:
          memory: 1g
          cpus: '0.75'
          pids: 50
